(function(){"use strict";var e={7474:function(e,t,n){var l=n(5130),r=n(6768);const i={id:"app"};function o(e,t,n,l,o,a){const u=(0,r.g2)("router-link"),s=(0,r.g2)("router-view");return(0,r.uX)(),(0,r.CE)("div",i,[(0,r.Lk)("nav",null,[(0,r.bF)(u,{to:"/"},{default:(0,r.k6)((()=>[(0,r.eW)("New Entry")])),_:1}),(0,r.bF)(u,{to:"/view-entries"},{default:(0,r.k6)((()=>[(0,r.eW)("View Entries")])),_:1})]),(0,r.bF)(s)])}var a={name:"App",components:{}},u=n(1241);const s=(0,u.A)(a,[["render",o]]);var c=s,d=n(1387),p=n(4232);const h={id:"app"},k=(0,r.Lk)("h1",null,"New Entry",-1),g={key:0},y=(0,r.Lk)("button",{onclick:"document.querySelector('input[type=file]').click()"},"Choose Files",-1),L={key:0},v=(0,r.Lk)("h3",null,"Waybill Information",-1),m=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"Waybill Number "),(0,r.Lk)("th",null,"Waybill Date"),(0,r.Lk)("th",null,"Mode Of Transport")])],-1),_={contenteditable:"true"},b=["value"],f=(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"Freight Type"),(0,r.Lk)("th",null,"Marks & Numbers"),(0,r.Lk)("th",null,"Package Type")],-1),C=["value"],T=["innerHTML"],D={contenteditable:"true"},E=["value"],w=(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"CPC Code"),(0,r.Lk)("th",null,"NPC Code"),(0,r.Lk)("th",null,"Number of Packages")],-1),x={contenteditable:"true"},F=["value"],O={contenteditable:"true"},I=["value"],N={contenteditable:"true"},B=(0,r.Lk)("h3",null,"Entry Information",-1),A=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"Consignee"),(0,r.Lk)("th",null,"Shipper"),(0,r.Lk)("th",null,"Supplier")])],-1),S=(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"Total Cargo Value"),(0,r.Lk)("th",null,"Freight Charge"),(0,r.Lk)("th",null,"Rate of Exchange")],-1),P=["innerHTML"],V=["innerHTML"],X=["innerHTML"],M=(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"Net Weight"),(0,r.Lk)("th",null,"Gross Weight"),(0,r.Lk)("th",null,"Country of Origin")],-1),H=["innerHTML"],U=["innerHTML"],R={contenteditable:"true"},W=(0,r.Lk)("option",{disabled:"",value:""},"Please select one",-1),q=["value"],$=(0,r.Lk)("h3",null,"Header Information",-1),K=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"Invoice #"),(0,r.Lk)("th",null,"Invoice Date"),(0,r.Lk)("th",null,"Supplier Name")])],-1),j=["onBlur"],Q=["onBlur"],z=["onBlur"],G=(0,r.Lk)("h3",null,"Line Details",-1),J=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"Product Code"),(0,r.Lk)("th",null,"Description"),(0,r.Lk)("th",null,"THN Code"),(0,r.Lk)("th",null,"Unit Quantity"),(0,r.Lk)("th",null,"Unit Price"),(0,r.Lk)("th",null,"Extension Price"),(0,r.Lk)("th",null,"Actions")])],-1),Y=["onBlur"],Z=["onBlur"],ee=["onInput","onBlur"],te=["onBlur"],ne=["onBlur"],le=["onBlur"],re=["onClick"],ie={colspan:"7"},oe=["onClick"],ae=(0,r.Lk)("h3",null,"Footer Information",-1),ue=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"Invoice Total"),(0,r.Lk)("th",null,"Trucking"),(0,r.Lk)("th",null,"Final Total")])],-1),se=["onBlur"],ce=["onBlur"],de=["onBlur"],pe=(0,r.Lk)("h3",null,"Calculated Check",-1),he=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"Total Extension Prices"),(0,r.Lk)("th",null,"Number of Line Items"),(0,r.Lk)("th",null,"Matches Invoice Total?")])],-1),ke={key:1},ge=["disabled"],ye=(0,r.Lk)("td",null,null,-1);function Le(e,t,n,i,o,a){return(0,r.uX)(),(0,r.CE)("div",h,[k,(0,r.bo)((0,r.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>o.referenceNumber=e),placeholder:"Enter Reference Number",onInput:t[1]||(t[1]=(...e)=>a.validateInput&&a.validateInput(...e))},null,544),[[l.Jo,o.referenceNumber]]),o.isValidReference?((0,r.uX)(),(0,r.CE)("div",g,[(0,r.Lk)("div",{class:"dropzone",onDragover:t[4]||(t[4]=(0,l.D$)(((...e)=>a.dragOver&&a.dragOver(...e)),["prevent"])),onDragenter:t[5]||(t[5]=(0,l.D$)(((...e)=>a.dragEnter&&a.dragEnter(...e)),["prevent"])),onDragleave:t[6]||(t[6]=(0,l.D$)(((...e)=>a.dragLeave&&a.dragLeave(...e)),["prevent"])),onDrop:t[7]||(t[7]=(0,l.D$)(((...t)=>e.handleDrop&&e.handleDrop(...t)),["prevent"]))},[(0,r.eW)(" Drop files here or "),(0,r.Lk)("input",{type:"file",multiple:"",onChange:t[2]||(t[2]=(...e)=>a.handleFileUpload&&a.handleFileUpload(...e)),style:{display:"none"}},null,32),y,(0,r.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>a.uploadFiles&&a.uploadFiles(...e))},"Upload Files")],32),o.selectedFiles.length?((0,r.uX)(),(0,r.CE)("div",L,[(0,r.Lk)("ul",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.selectedFiles,((e,t)=>((0,r.uX)(),(0,r.CE)("li",{key:t},(0,p.v_)(e.name),1)))),128))]),v,(0,r.Lk)("table",null,[m,(0,r.Lk)("tbody",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("td",{contenteditable:"true",onBlur:t[8]||(t[8]=e=>a.updateEntryFields("waybillNumber",e.target.innerText))},null,32),(0,r.Lk)("td",_,[(0,r.bo)((0,r.Lk)("input",{type:"date","onUpdate:modelValue":t[9]||(t[9]=e=>o.waybillDate=e)},null,512),[[l.Jo,o.waybillDate]])]),(0,r.Lk)("td",null,[(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":t[10]||(t[10]=e=>o.modeOfTransport=e),onChange:t[11]||(t[11]=(...e)=>a.toggleOptions&&a.toggleOptions(...e))},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.modeOfTransportOOptions,(e=>((0,r.uX)(),(0,r.CE)("option",{key:e,value:e},(0,p.v_)(e),9,b)))),128))],544),[[l.u1,o.modeOfTransport]])])]),f,(0,r.Lk)("tr",null,[(0,r.Lk)("td",null,[(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":t[12]||(t[12]=e=>o.freightType=e),onChange:t[13]||(t[13]=(...e)=>a.toggleOptions&&a.toggleOptions(...e))},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.freightTypeOptions,(e=>((0,r.uX)(),(0,r.CE)("option",{key:e,value:e},(0,p.v_)(e),9,C)))),128))],544),[[l.u1,o.freightType]])]),(0,r.Lk)("td",{contenteditable:"true",innerHTML:o.marksAndNumbers,onBlur:t[14]||(t[14]=e=>a.updateEntryFields("marksAndNumbers",e.target.innerText))},null,40,T),(0,r.Lk)("td",D,[(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":t[15]||(t[15]=e=>o.kindOfPackage=e),onChange:t[16]||(t[16]=(...e)=>a.toggleOptions&&a.toggleOptions(...e))},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.packageTypeOptions,(e=>((0,r.uX)(),(0,r.CE)("option",{key:e.value,value:e.value},(0,p.v_)(e.text),9,E)))),128))],544),[[l.u1,o.kindOfPackage]])])]),w,(0,r.Lk)("tr",null,[(0,r.Lk)("td",x,[(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":t[17]||(t[17]=e=>o.cpcCode=e),onChange:t[18]||(t[18]=(...e)=>a.toggleOptions&&a.toggleOptions(...e))},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.cpcCodeOptions,(e=>((0,r.uX)(),(0,r.CE)("option",{key:e,value:e},(0,p.v_)(e),9,F)))),128))],544),[[l.u1,o.cpcCode]])]),(0,r.Lk)("td",O,[(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":t[19]||(t[19]=e=>o.npcCode=e),onChange:t[20]||(t[20]=(...e)=>a.toggleOptions&&a.toggleOptions(...e))},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.npcCodeOptions,(e=>((0,r.uX)(),(0,r.CE)("option",{key:e,value:e},(0,p.v_)(e),9,I)))),128))],544),[[l.u1,o.npcCode]])]),(0,r.Lk)("td",N,[(0,r.bo)((0,r.Lk)("input",{type:"number","onUpdate:modelValue":t[21]||(t[21]=e=>o.numberOfPackages=e)},null,512),[[l.Jo,o.numberOfPackages]])])])])]),B,(0,r.Lk)("table",null,[A,(0,r.Lk)("tbody",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("td",{contenteditable:"true",onBlur:t[22]||(t[22]=e=>a.updateEntryFields("consignee",e.target.innerText))},null,32),(0,r.Lk)("td",{contenteditable:"true",onBlur:t[23]||(t[23]=e=>a.updateEntryFields("shipper",e.target.innerText))},null,32),(0,r.Lk)("td",{contenteditable:"true",onBlur:t[24]||(t[24]=e=>a.updateEntryFields("supplier",e.target.innerText))},null,32)]),S,(0,r.Lk)("tr",null,[(0,r.Lk)("td",{contenteditable:"true",innerHTML:o.totalCargoValue,onBlur:t[25]||(t[25]=e=>a.updateEntryFields("totalCargoValue",e.target.innerText))},null,40,P),(0,r.Lk)("td",{contenteditable:"true",innerHTML:o.freightCharge,onBlur:t[26]||(t[26]=e=>a.updateEntryFields("freightCharge",e.target.innerText))},null,40,V),(0,r.Lk)("td",{contenteditable:"true",innerHTML:o.rateOfExchange,onBlur:t[27]||(t[27]=e=>a.updateEntryFields("rateOfExchange",e.target.innerText))},null,40,X)]),M,(0,r.Lk)("tr",null,[(0,r.Lk)("td",{contenteditable:"true",innerHTML:o.netWeight,onBlur:t[28]||(t[28]=e=>a.updateEntryFields("netWeight",e.target.innerText))},null,40,H),(0,r.Lk)("td",{contenteditable:"true",innerHTML:o.grossWeight,onBlur:t[29]||(t[29]=e=>a.updateEntryFields("grossWeight",e.target.innerText))},null,40,U),(0,r.Lk)("td",R,[(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":t[30]||(t[30]=e=>o.countryOfOrigin=e),id:"country"},[W,((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.countries,(e=>((0,r.uX)(),(0,r.CE)("option",{key:e.code,value:e.code},(0,p.v_)(e.code)+" - "+(0,p.v_)(e.name),9,q)))),128))],512),[[l.u1,o.countryOfOrigin]])])])])])])):(0,r.Q3)("",!0)])):(0,r.Q3)("",!0),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.invoiceDataArray,((e,t)=>((0,r.uX)(),(0,r.CE)("div",{key:t},[(0,r.Lk)("h2",null,"Invoice Data #"+(0,p.v_)(t+1),1),$,(0,r.Lk)("table",null,[K,(0,r.Lk)("tbody",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("td",{contenteditable:"true",onBlur:t=>a.updateData(e,"invoice_id",t.target.innerText)},(0,p.v_)(e.invoice_id||"N/A"),41,j),(0,r.Lk)("td",{contenteditable:"true",onBlur:t=>a.updateData(e,"invoice_date",t.target.innerText)},(0,p.v_)(e.invoice_date||"N/A"),41,Q),(0,r.Lk)("td",{contenteditable:"true",onBlur:t=>a.updateData(e,"vendor_name",t.target.innerText)},(0,p.v_)(e.vendor_name||"N/A"),41,z)])])]),G,(0,r.Lk)("table",null,[J,(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.invoice_items,((t,n)=>((0,r.uX)(),(0,r.CE)("tr",{key:n},[(0,r.Lk)("td",{contenteditable:"true",onBlur:t=>a.updateItem(e,n,"product_code",t.target.innerText)},(0,p.v_)(t.product_code||"N/A"),41,Y),(0,r.Lk)("td",{contenteditable:"true",onBlur:t=>a.updateItem(e,n,"description",t.target.innerText)},(0,p.v_)(t.description||"N/A"),41,Z),(0,r.Lk)("td",{contenteditable:"true",onInput:e=>a.handleInput(e,n,"thn_code"),onBlur:t=>a.updateItem(e,n,"thn_code",t.target.innerText)},(0,p.v_)(t.thn_code||"N/A"),41,ee),(0,r.Lk)("td",{contenteditable:"true",onBlur:t=>a.updateItem(e,n,"quantity",t.target.innerText),style:(0,p.Tr)(a.naStyle(t.quantity))},(0,p.v_)(t.quantity||"N/A"),45,te),(0,r.Lk)("td",{contenteditable:"true",onBlur:t=>a.updateItem(e,n,"unit_price",t.target.innerText),style:(0,p.Tr)(a.naStyle(t.unit_price))},(0,p.v_)(t.unit_price||"N/A"),45,ne),(0,r.Lk)("td",{contenteditable:"true",onBlur:t=>a.updateItem(e,n,"amount",t.target.innerText),style:(0,p.Tr)(a.extensionStyle(t))},(0,p.v_)(t.amount||"N/A"),45,le),(0,r.Lk)("td",null,[(0,r.Lk)("button",{onClick:t=>a.deleteRow(e,n)},"Delete",8,re)])])))),128))]),(0,r.Lk)("tfoot",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("td",ie,[(0,r.Lk)("button",{onClick:t=>a.addNewLine(e)},"Add New Line",8,oe)])])])]),ae,(0,r.Lk)("table",null,[ue,(0,r.Lk)("tbody",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("td",{contenteditable:"true",onBlur:t=>a.updateData(e,"invoice_total",t.target.innerText),style:(0,p.Tr)(a.naStyle(e.invoice_total))},(0,p.v_)(e.invoice_total||"N/A"),45,se),(0,r.Lk)("td",{contenteditable:"true",onBlur:t=>a.updateData(e,"trucking",t.target.innerText),style:(0,p.Tr)(a.naStyle(e.trucking))},(0,p.v_)(e.trucking||"N/A"),45,ce),(0,r.Lk)("td",{contenteditable:"true",onBlur:t=>a.updateData(e,"final_total",t.target.innerText),style:(0,p.Tr)(a.naStyle(e.final_total))},(0,p.v_)(e.final_total||"N/A"),45,de)])])]),pe,(0,r.Lk)("table",null,[he,(0,r.Lk)("tbody",null,[(0,r.Lk)("tr",{style:(0,p.Tr)(a.checkInvoiceTotal(e))},[(0,r.Lk)("td",null,(0,p.v_)(a.calculateTotalExtensionPrice(e.invoice_items)),1),(0,r.Lk)("td",null,(0,p.v_)(e.invoice_items.length),1),(0,r.Lk)("td",null,(0,p.v_)(a.calculateTotalExtensionPrice(e.invoice_items)===parseFloat(e.invoice_total).toFixed(2)?"Yes":"No"),1)],4)])])])))),128)),o.selectedFiles.length?((0,r.uX)(),(0,r.CE)("div",ke,[(0,r.Lk)("table",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("td",null,[(0,r.Lk)("button",{disabled:a.entryButtonDisabled,onClick:t[31]||(t[31]=e=>a.createInvoices(o.invoiceDataArray))},"Save Entry",8,ge)]),ye])])])):(0,r.Q3)("",!0)])}n(4114),n(4603),n(7566),n(8721);var ve=n(8047),me=n.n(ve);const _e="https://mawifrontend.azurewebsites.net/",be=async(e,t,n=null)=>{try{const l=await me()({method:e,url:t,data:n});return l.data}catch(l){throw console.error("API error:",l),l}},fe=async e=>await be("post",`${_e}commercial_invoices`,e);var Ce=n(4874),Te=n.n(Ce);function De(e){Te().fire({position:"top-end",toast:!0,icon:"success",title:e,showConfirmButton:!1,timer:2e3,timerProgressBar:!0})}function Ee(){Te().close()}function we(e){Te().fire({icon:"error",title:"Oops...",text:e})}function xe(e){Te().fire({title:"One moment...",html:e,allowOutsideClick:!1,showConfirmButton:!1,willOpen:()=>{Te().showLoading()}})}var Fe={name:"App",data(){return{referenceNumber:"",selectedFiles:[],invoiceDataArray:[],isDragOver:!1,isValidReference:!1,waybillNumber:"",waybillDate:(new Date).toISOString().substr(0,10),modeOfTransport:"",freightType:"",marksAndNumbers:"As Addressed",countryOfOrigin:"",cpcCode:"4000",npcCode:"0000",kindOfPackage:"CT",numberOfPackages:"",consignee:"",shipper:"",supplier:"",totalCargoValue:0,freightCharge:0,rateOfExchange:1,netWeight:0,grossWeight:0,editableContent:"0",countries:[],modeOfTransportOOptions:["Air","Ocean"],freightTypeOptions:["FCL","LCL","Bulk","Break Bulk"],cpcCodeOptions:["4000"],npcCodeOptions:["0000"],packageTypeOptions:[{value:"CT",text:"Carton"}],showModeofTransportDropdown:!1}},setup(){return{}},mounted(){this.fetchCountries(),this.updateEntryFields("marksAndNumbers","As Addressed"),this.calculateTotalCargoValue()},computed:{entryButtonDisabled(){return!(this.hasInvoiceNumber||this.waybillNumber.trim().length>0||this.consignee.trim().length>0)},hasInvoiceNumber(){for(let e of this.invoiceDataArray)if(e.invoice_id&&e.invoice_id.trim().length>0)return console.log("Invoice Number Found"),!0;return console.log("Invoice Number Not Found"),!1}},methods:{formatInvoiceData(){this.invoiceDataArray.forEach((e=>{e.invoice_total=this.parseFloatFromString(e.invoice_total),e.trucking=this.parseFloatFromString(e.trucking),e.final_total=this.parseFloatFromString(e.final_total),e.invoice_items.forEach((e=>{e.quantity=this.parseFloatFromString(e.quantity),e.unit_price=this.parseFloatFromString(e.unit_price),e.amount=this.parseFloatFromString(e.amount)}))}))},calculateTotalCargoValue(){let e=0;for(let t of this.invoiceDataArray)console.log(t.invoice_total),e+=this.parseFloatFromString(t.invoice_total);this.totalCargoValue=e},validateIntegerInput(e){let t=e.target.innerText.trim();/^\d+$/.test(t)?this.editableContent=t:e.target.innerText=this.editableContent,this.moveCursorToEnd(e.target)},async fetchCountries(){try{const e=await fetch("https://restcountries.com/v3.1/all"),t=await e.json();this.countries=t.map((e=>({name:e.name.common,code:e.cca2})))}catch(e){console.error("Failed to fetch countries:",e)}},toggleOptions(){console.log(this.freightType)},updateEntryFields(e,t){console.log(e,t),this[e]=t},selectOption(e){this.$refs.editableDiv.innerText=e,this.showModeofTransportDropdown=!1},async createInvoices(e){const t={referenceNumber:this.referenceNumber,waybillNumber:this.waybillNumber,waybillDate:this.waybillDate,modeOfTransport:this.modeOfTransport,freightType:this.freightType,marksAndNumbers:this.marksAndNumbers,countryOfOrigin:this.countryOfOrigin,cpcCode:this.cpcCode,npcCode:this.npcCode,kindOfPackage:this.kindOfPackage,numberOfPackages:this.numberOfPackages,consignee:this.consignee,shipper:this.shipper,supplier:this.supplier,totalCargoValue:this.totalCargoValue,freightCharge:this.freightCharge,rateOfExchange:this.rateOfExchange,netWeight:this.netWeight,grossWeight:this.grossWeight,invoiceList:e};console.log(t);try{xe("Saving your Entry..."),await fe(t),Ee(),De("Entry created successfully")}catch(n){console.error("Failed to create the invoice:",n),we("Failed to create the Entry. Please try again.")}},handleInput(e,t,n){const l=e.target.innerText,r=l.replace(/[^0-9]/g,""),i=this.formatValue(r);e.target.innerText=i,this.moveCursorToEnd(e.target)},formatValue(e){let t="";for(let n=0;n<e.length;n++)4!==n&&6!==n||(t+="."),t+=e[n];return this.truncateString(t)},truncateString(e){return e.length>10?e.substring(0,10):e},moveCursorToEnd(e){const t=document.createRange(),n=window.getSelection();t.selectNodeContents(e),t.collapse(!1),n.removeAllRanges(),n.addRange(t)},validateInput(){this.isValidReference=this.referenceNumber.trim().length>0},handleFileUpload(e){this.isValidReference&&(this.selectedFiles=Array.from(e.target.files))},dragOver(e){this.isValidReference&&(this.isDragOver=!0)},dragEnter(e){this.isValidReference&&(this.isDragOver=!0)},dragLeave(e){this.isValidReference&&(this.isDragOver=!1)},uploadFiles(){if(!this.isValidReference||0===this.selectedFiles.length)return void alert("Please enter a valid reference number and select files before uploading.");const e=new FormData;e.append("reference",this.referenceNumber),this.selectedFiles.forEach((t=>{e.append("files",t)})),xe("Reading your invoice..."),fetch("https://gabrielle-flask.azurewebsites.net/read_vendor_invoice",{method:"POST",body:e}).then((e=>e.json())).then((e=>{this.invoiceDataArray=e,this.formatInvoiceData(),Ee(),De("Invoice data read successfully."),this.calculateTotalCargoValue()})).catch((e=>{console.error("Error:",e),this.invoiceDataArray=[]}))},calculateTotalExtensionPrice(e){return e.reduce(((e,t)=>e+this.parseFloatFromString(t.amount||0)),0).toFixed(2)},updateData(e,t,n){e[t]=n},updateItem(e,t,n,l){e.invoice_items[t][n]=l},deleteRow(e,t){e.invoice_items.splice(t,1)},addNewLine(e){const t={product_code:"",description:"",thn_code:"",quantity:"",unit_price:"",amount:""};e.invoice_items.push(t)},extensionStyle(e){const t=(parseFloat(e.unit_price)*parseFloat(e.quantity)).toFixed(2),n=parseFloat(e.amount).toFixed(2);return[e.unit_price,e.quantity,e.amount].some((e=>[null,void 0,"",!1].includes(e)))?{backgroundColor:"yellow",color:"black"}:t!==n?{backgroundColor:"red",color:"white"}:{}},naStyle(e){return[null,void 0,"",!1].includes(e)?{backgroundColor:"yellow",color:"black"}:{}},checkInvoiceTotal(e){const t=this.calculateTotalExtensionPrice(e.invoice_items);console.log(e),console.log(t,e.invoice_total);const n=parseFloat(e.invoice_total||0).toFixed(2);return t!==n?{backgroundColor:"red",color:"white"}:{}},parseFloatFromString(e){if(!e||void 0===e||null===e)return 0;if("number"===typeof e)return e;let t=e.replace(/[^0-9.]/g,""),n=parseFloat(t);return n},exportToXML(){let e='<?xml version="1.0" encoding="UTF-8"?>\n';e+="<ASYCUDA>\n",this.invoiceDataArray.forEach(((t,n)=>{e+=`  <Invoice index="${n}">\n`,t.invoice_items.forEach(((t,n)=>{e+=`    <Item index="${n}">\n`,e+=`      <ProductCode>${t.product_code}</ProductCode>\n`,e+=`      <Description>${t.description}</Description>\n`,e+=`      <THNCode>${t.thn_code}</THNCode>\n`,e+=`      <Quantity>${t.quantity}</Quantity>\n`,e+=`      <UnitPrice>${t.unit_price}</UnitPrice>\n`,e+=`      <ExtensionPrice>${t.amount}</ExtensionPrice>\n`,e+="    </Item>\n"})),e+="  </Invoice>\n"})),e+="</ASYCUDA>\n";const t=new Blob([e],{type:"application/xml"}),n=document.createElement("a");n.href=URL.createObjectURL(t),n.download="invoices.xml",n.click(),URL.revokeObjectURL(n.href)}}};const Oe=(0,u.A)(Fe,[["render",Le]]);var Ie=Oe;const Ne=(0,r.Lk)("h1",null,"Entries",-1),Be=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"Entry Number"),(0,r.Lk)("th",null,"Consignee"),(0,r.Lk)("th",null,"Invoice Number"),(0,r.Lk)("th",null,"Waybill Number"),(0,r.Lk)("th",null,"Actions")])],-1),Ae=["onClick"],Se={key:0,class:"error-message"};function Pe(e,t,n,i,o,a){return(0,r.uX)(),(0,r.CE)("div",null,[Ne,(0,r.bo)((0,r.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>o.searchTerm=e),placeholder:"Search entries"},null,512),[[l.Jo,o.searchTerm]]),(0,r.Lk)("table",null,[Be,(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(a.filteredEntries,(e=>((0,r.uX)(),(0,r.CE)("tr",{key:e.entry_id},[(0,r.Lk)("td",null,(0,p.v_)(e.entry_number),1),(0,r.Lk)("td",null,(0,p.v_)(e.consignee),1),(0,r.Lk)("td",null,(0,p.v_)(e.invoice_number?e.invoice_number.split("; ")[0]:""),1),(0,r.Lk)("td",null,(0,p.v_)(e.waybill_number),1),(0,r.Lk)("td",null,[(0,r.Lk)("button",{type:"button",onClick:t=>a.openEntry(e.entry_id)},"Edit Entry",8,Ae)])])))),128))])]),o.error?((0,r.uX)(),(0,r.CE)("div",Se,(0,p.v_)(o.error),1)):(0,r.Q3)("",!0)])}var Ve={data(){return{entries:[],error:null,searchTerm:""}},created(){this.fetchEntries()},methods:{openEntry(e){this.$router.push({name:"EntryDetails",params:{entryId:e}})},async fetchEntries(){try{const e=await me().get("https://mawifrontend.azurewebsites.net/entries");this.entries=e.data}catch(e){this.error=e.message,console.error("There was an error!",e)}}},computed:{filteredEntries(){if(!this.searchTerm)return this.entries;const e=this.searchTerm.toLowerCase();return this.entries.filter((t=>t.entry_number&&t.entry_number.toString().toLowerCase().includes(e)||t.waybill_number&&t.waybill_number.toString().toLowerCase().includes(e)||t.invoice_number&&t.invoice_number.split("; ").some((t=>t.toLowerCase().includes(e)))||t.consignee&&t.consignee.toString().toLowerCase().includes(e)))}}};const Xe=(0,u.A)(Ve,[["render",Pe]]);var Me=Xe;const He={key:0},Ue=(0,r.Lk)("h1",null,"Entry Details",-1),Re=(0,r.Lk)("h3",null,"Waybill Information",-1),We=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"Waybill Number "),(0,r.Lk)("th",null,"Waybill Date"),(0,r.Lk)("th",null,"Mode Of Transport")])],-1),qe=["innerHTML"],$e={contenteditable:"true"},Ke=["value"],je=(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"Freight Type"),(0,r.Lk)("th",null,"Marks & Numbers"),(0,r.Lk)("th",null,"Package Type")],-1),Qe=["value"],ze=["innerHTML"],Ge={contenteditable:"true"},Je=["value"],Ye=(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"CPC Code"),(0,r.Lk)("th",null,"NPC Code"),(0,r.Lk)("th",null,"Number of Packages")],-1),Ze={contenteditable:"true"},et=["value"],tt={contenteditable:"true"},nt=["value"],lt={contenteditable:"true"},rt=(0,r.Lk)("h3",null,"Entry Information",-1),it=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"Consignee"),(0,r.Lk)("th",null,"Shipper"),(0,r.Lk)("th",null,"Supplier")])],-1),ot=["innerHTML"],at=["innerHTML"],ut=["innerHTML"],st=(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"Total Cargo Value"),(0,r.Lk)("th",null,"Freight Charge"),(0,r.Lk)("th",null,"Rate of Exchange")],-1),ct=["innerHTML"],dt=["innerHTML"],pt=["innerHTML"],ht=(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"Net Weight"),(0,r.Lk)("th",null,"Gross Weight"),(0,r.Lk)("th",null,"Country of Origin")],-1),kt=["innerHTML"],gt=["innerHTML"],yt={contenteditable:"true"},Lt=(0,r.Lk)("option",{disabled:"",value:""},"Please select one",-1),vt=["value"],mt={key:0},_t=(0,r.Lk)("h3",null,"Commercial Invoices",-1),bt=(0,r.Lk)("h3",null,"Header Information",-1),ft=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"Invoice #"),(0,r.Lk)("th",null,"Invoice Date"),(0,r.Lk)("th",null,"Supplier Name")])],-1),Ct=["onBlur"],Tt=["onBlur"],Dt=["onBlur"],Et=(0,r.Lk)("h3",null,"Line Details",-1),wt=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"Product Code"),(0,r.Lk)("th",null,"Description"),(0,r.Lk)("th",null,"THN Code"),(0,r.Lk)("th",null,"Unit Quantity"),(0,r.Lk)("th",null,"Unit Price"),(0,r.Lk)("th",null,"Extension Price"),(0,r.Lk)("th",null,"Actions")])],-1),xt=["onBlur"],Ft=["onBlur"],Ot=["onBlur"],It=["onBlur"],Nt=["onBlur"],Bt=["onBlur"],At=["onClick"],St={colspan:"7"},Pt=["onClick"],Vt=(0,r.Lk)("h3",null,"Footer Information",-1),Xt=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"Invoice Total"),(0,r.Lk)("th",null,"Trucking"),(0,r.Lk)("th",null,"Final Total")])],-1),Mt=["onBlur"],Ht=["onBlur"],Ut=["onBlur"],Rt=(0,r.Lk)("h3",null,"Calculated Check",-1),Wt=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"Total Extension Prices"),(0,r.Lk)("th",null,"Number of Line Items"),(0,r.Lk)("th",null,"Matches Invoice Total?")])],-1),qt=["disabled"];function $t(e,t,n,i,o,a){return o.dataRetrieved?((0,r.uX)(),(0,r.CE)("div",He,[Ue,(0,r.Lk)("h2",null,"Reference Number: "+(0,p.v_)(this.entryDetails?.entry_number),1),Re,(0,r.Lk)("table",null,[We,(0,r.Lk)("tbody",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("td",{contenteditable:"true",innerHTML:o.entryDetails?.waybill_number,onBlur:t[0]||(t[0]=e=>a.updateEntryFields("waybill_number",e.target.innerText))},null,40,qe),(0,r.Lk)("td",$e,[(0,r.bo)((0,r.Lk)("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]=e=>a.formattedDate=e)},null,512),[[l.Jo,a.formattedDate]])]),(0,r.Lk)("td",null,[(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>o.entryDetails.mode_of_transport=e),onChange:t[3]||(t[3]=(...e)=>a.toggleOptions&&a.toggleOptions(...e))},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.modeOfTransportOOptions,(e=>((0,r.uX)(),(0,r.CE)("option",{key:e,value:e},(0,p.v_)(e),9,Ke)))),128))],544),[[l.u1,o.entryDetails.mode_of_transport]])])]),je,(0,r.Lk)("tr",null,[(0,r.Lk)("td",null,[(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>o.entryDetails.freight_type=e),onChange:t[5]||(t[5]=(...e)=>a.toggleOptions&&a.toggleOptions(...e))},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.freightTypeOptions,(e=>((0,r.uX)(),(0,r.CE)("option",{key:e,value:e},(0,p.v_)(e),9,Qe)))),128))],544),[[l.u1,o.entryDetails.freight_type]])]),(0,r.Lk)("td",{contenteditable:"true",innerHTML:o.entryDetails.marks_and_numbers,onBlur:t[6]||(t[6]=e=>a.updateEntryFields("marks_and_numbers",e.target.innerText))},null,40,ze),(0,r.Lk)("td",Ge,[(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":t[7]||(t[7]=e=>o.entryDetails.package_type=e),onChange:t[8]||(t[8]=(...e)=>a.toggleOptions&&a.toggleOptions(...e))},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.packageTypeOptions,(e=>((0,r.uX)(),(0,r.CE)("option",{key:e.value,value:e.value},(0,p.v_)(e.text),9,Je)))),128))],544),[[l.u1,o.entryDetails.package_type]])])]),Ye,(0,r.Lk)("tr",null,[(0,r.Lk)("td",Ze,[(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":t[9]||(t[9]=e=>o.entryDetails.cpc_code=e),onChange:t[10]||(t[10]=(...e)=>a.toggleOptions&&a.toggleOptions(...e))},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.cpcCodeOptions,(e=>((0,r.uX)(),(0,r.CE)("option",{key:e,value:e},(0,p.v_)(e),9,et)))),128))],544),[[l.u1,o.entryDetails.cpc_code]])]),(0,r.Lk)("td",tt,[(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":t[11]||(t[11]=e=>o.entryDetails.npc_code=e),onChange:t[12]||(t[12]=(...e)=>a.toggleOptions&&a.toggleOptions(...e))},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.npcCodeOptions,(e=>((0,r.uX)(),(0,r.CE)("option",{key:e,value:e},(0,p.v_)(e),9,nt)))),128))],544),[[l.u1,o.entryDetails.npc_code]])]),(0,r.Lk)("td",lt,[(0,r.bo)((0,r.Lk)("input",{type:"number","onUpdate:modelValue":t[13]||(t[13]=e=>o.entryDetails.package_quantity=e)},null,512),[[l.Jo,o.entryDetails.package_quantity]])])])])]),rt,(0,r.Lk)("table",null,[it,(0,r.Lk)("tbody",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("td",{contenteditable:"true",innerHTML:o.entryDetails.consignee,onBlur:t[14]||(t[14]=e=>a.updateEntryFields("consignee",e.target.innerText))},null,40,ot),(0,r.Lk)("td",{contenteditable:"true",innerHTML:o.entryDetails.shipper,onBlur:t[15]||(t[15]=e=>a.updateEntryFields("shipper",e.target.innerText))},null,40,at),(0,r.Lk)("td",{contenteditable:"true",innerHTML:o.entryDetails.supplier_name,onBlur:t[16]||(t[16]=e=>a.updateEntryFields("supplier",e.target.innerText))},null,40,ut)]),st,(0,r.Lk)("tr",null,[(0,r.Lk)("td",{contenteditable:"true",innerHTML:o.entryDetails.invoice_total,onBlur:t[17]||(t[17]=e=>a.updateEntryFields("invoice_total",e.target.innerText))},null,40,ct),(0,r.Lk)("td",{contenteditable:"true",innerHTML:o.entryDetails.freight_charge,onBlur:t[18]||(t[18]=e=>a.updateEntryFields("freight_charge",e.target.innerText))},null,40,dt),(0,r.Lk)("td",{contenteditable:"true",innerHTML:o.entryDetails.rate_of_exchange,onBlur:t[19]||(t[19]=e=>a.updateEntryFields("rate_of_exchange",e.target.innerText))},null,40,pt)]),ht,(0,r.Lk)("tr",null,[(0,r.Lk)("td",{contenteditable:"true",innerHTML:o.entryDetails.net_weight,onBlur:t[20]||(t[20]=e=>a.updateEntryFields("net_weight",e.target.innerText))},null,40,kt),(0,r.Lk)("td",{contenteditable:"true",innerHTML:o.entryDetails.gross_weight,onBlur:t[21]||(t[21]=e=>a.updateEntryFields("gross_weight",e.target.innerText))},null,40,gt),(0,r.Lk)("td",yt,[(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":t[22]||(t[22]=e=>o.entryDetails.country_of_origin=e),id:"country"},[Lt,((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.countries,(e=>((0,r.uX)(),(0,r.CE)("option",{key:e.code,value:e.code},(0,p.v_)(e.code)+" - "+(0,p.v_)(e.name),9,vt)))),128))],512),[[l.u1,o.entryDetails.country_of_origin]])])])])]),o.dataRetrieved?((0,r.uX)(),(0,r.CE)("div",mt,[_t,((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.commercialInvoices,((e,n)=>((0,r.uX)(),(0,r.CE)("div",{key:n},[(0,r.Lk)("h2",null,"Invoice Data #"+(0,p.v_)(n+1),1),bt,(0,r.Lk)("table",null,[ft,(0,r.Lk)("tbody",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("td",{contenteditable:"true",onBlur:t=>a.updateInvoiceData(e,"invoice_number",t.target.innerText)},(0,p.v_)(e.invoice_number||"N/A"),41,Ct),(0,r.Lk)("td",{contenteditable:"true",onBlur:t=>a.updateInvoiceData(e,"invoice_date",t.target.innerText)},(0,p.v_)(e.invoice_date||"N/A"),41,Tt),(0,r.Lk)("td",{contenteditable:"true",onBlur:t=>a.updateInvoiceData(e,"vendor_name",t.target.innerText)},(0,p.v_)(e.supplier_name||"N/A"),41,Dt)])])]),Et,(0,r.Lk)("table",null,[wt,(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.lines,((n,l)=>((0,r.uX)(),(0,r.CE)("tr",{key:l},[(0,r.Lk)("td",{contenteditable:"true",onBlur:e=>a.updateInvoiceData(n,"product_code",e.target.innerText)},(0,p.v_)(n.product_code||"N/A"),41,xt),(0,r.Lk)("td",{contenteditable:"true",onBlur:e=>a.updateInvoiceData(n,"description",e.target.innerText)},(0,p.v_)(n.description||"N/A"),41,Ft),(0,r.Lk)("td",{contenteditable:"true",onInput:t[23]||(t[23]=e=>a.handleInput(e)),onBlur:e=>a.updateInvoiceData(n,"tariff_code",e.target.innerText)},(0,p.v_)(n.tariff_code||"N/A"),41,Ot),(0,r.Lk)("td",{contenteditable:"true",onBlur:e=>a.updateInvoiceData(n,"quantity",e.target.innerText),style:(0,p.Tr)(a.naStyle(n.quantity))},(0,p.v_)(n.quantity||"N/A"),45,It),(0,r.Lk)("td",{contenteditable:"true",onBlur:e=>a.updateInvoiceData(n,"unit_price",e.target.innerText),style:(0,p.Tr)(a.naStyle(n.unit_price))},(0,p.v_)(n.unit_price||"N/A"),45,Nt),(0,r.Lk)("td",{contenteditable:"true",onBlur:e=>a.updateInvoiceData(n,"extension_price",e.target.innerText),style:(0,p.Tr)(a.extensionStyle(n))},(0,p.v_)(n.extension_price||"N/A"),45,Bt),(0,r.Lk)("td",null,[(0,r.Lk)("button",{onClick:t=>a.deleteRow(e,l)},"Delete",8,At)])])))),128))]),(0,r.Lk)("tfoot",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("td",St,[(0,r.Lk)("button",{onClick:t=>a.addNewLine(e)},"Add New Line",8,Pt)])])])]),Vt,(0,r.Lk)("table",null,[Xt,(0,r.Lk)("tbody",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("td",{contenteditable:"true",onBlur:t=>a.updateInvoiceData(e,"invoice_total",t.target.innerText),style:(0,p.Tr)(a.naStyle(e.invoice_total))},(0,p.v_)(e.invoice_total||"N/A"),45,Mt),(0,r.Lk)("td",{contenteditable:"true",onBlur:t=>a.updateInvoiceData(e,"trucking",t.target.innerText),style:(0,p.Tr)(a.naStyle(e.trucking))},(0,p.v_)(e.trucking||"N/A"),45,Ht),(0,r.Lk)("td",{contenteditable:"true",onBlur:t=>a.updateInvoiceData(e,"final_total",t.target.innerText),style:(0,p.Tr)(a.naStyle(e.final_total))},(0,p.v_)(e.final_total||"N/A"),45,Ut)])])]),Rt,(0,r.Lk)("table",null,[Wt,(0,r.Lk)("tbody",null,[(0,r.Lk)("tr",{style:(0,p.Tr)(a.checkInvoiceTotal(e))},[(0,r.Lk)("td",null,(0,p.v_)(a.calculateTotalExtensionPrice(e.lines)),1),(0,r.Lk)("td",null,(0,p.v_)(e.lines.length),1),(0,r.Lk)("td",null,(0,p.v_)(a.calculateTotalExtensionPrice(e.lines)===parseFloat(e.invoice_total).toFixed(2)?"Yes":"No"),1)],4)])])])))),128)),(0,r.Lk)("div",null,[(0,r.Lk)("table",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("td",null,[(0,r.Lk)("button",{disabled:a.isGenerateCsvDisabled,onClick:t[24]||(t[24]=(...e)=>a.generateCSV&&a.generateCSV(...e))},"Generate CSV File",8,qt)]),(0,r.Lk)("td",null,[(0,r.Lk)("button",{onClick:t[25]||(t[25]=(...e)=>a.saveData&&a.saveData(...e))},"Save Entry")])])])])])):(0,r.Q3)("",!0)])):(0,r.Q3)("",!0)}var Kt={name:"EntryDetails",props:{entryId:{type:[String,Number],required:!0}},computed:{formattedDate:{get(){const e=new Date(this.entryDetails.waybill_date);return e.toISOString().split("T")[0]},set(e){this.entryDetails.waybill_date=e}},isGenerateCsvDisabled(){return this.commercialInvoices.some((e=>(console.log("Tariff Check"+e),e.lines.some((e=>!e.tariff_code||""===e.tariff_code.trim())))))}},data(){return{entryDetails:null,waybill:{},entry:{},commercialInvoices:[],dataRetrieved:!1,loading:!1,error:null,countries:[],modeOfTransportOOptions:["Air","Ocean"],freightTypeOptions:["FCL","LCL","Bulk","Break Bulk"],cpcCodeOptions:["4000"],npcCodeOptions:["0000"],packageTypeOptions:[{value:"CT",text:"Carton"}]}},mounted(){this.fetchAllDetails(),this.fetchCountries()},methods:{updateWaybillDate(e){this.entryDetails.waybill_date=e.target.value},async fetchCountries(){try{const e=await fetch("https://restcountries.com/v3/all"),t=await e.json();this.countries=t.map((e=>({name:e.name.common,code:e.cca2})))}catch(e){console.error("Failed to fetch countries:",e)}},formatInvoiceData(e){return{invoice_id:e.invoice_id,invoice_number:e.invoice_number,invoice_date:e.invoice_date,invoice_total:e.invoice_total,sub_total:e.sub_total,supplier_name:e.supplier_name,taxed_amount:e.taxed_amount,supplier_address:e.supplier_address,purchase_order_number:e.purchase_order_number,entry_id:e.entry_id}},formatInvoiceLinesData(e){return e.map((e=>({invoice_line_id:e.invoice_line_id,description:e.description,quantity:e.quantity,unit_price:e.unit_price,extension_price:e.extension_price,tariff_code:e.tariff_code,product_code:e.product_code})))},handleInput(e){const t=e.target.innerText,n=t.replace(/[^0-9]/g,""),l=this.formatValue(n);e.target.innerText=l,this.moveCursorToEnd(e.target)},formatValue(e){let t="";for(let n=0;n<e.length;n++)4!==n&&6!==n||(t+="."),t+=e[n];return this.truncateString(t)},truncateString(e){return e.length>10?e.substring(0,10):e},deleteRow(e,t){e.lines.splice(t,1)},addNewLine(e){const t={product_code:"",description:"",thn_code:"",quantity:"",unit_price:"",amount:""};e.lines.push(t)},moveCursorToEnd(e){const t=document.createRange(),n=window.getSelection();t.selectNodeContents(e),t.collapse(!1),n.removeAllRanges(),n.addRange(t)},saveData(){console.log("Saving data..."),this.loading=!0,xe("Saving Data..."),Promise.all([this.updateEntryData(),this.updateWaybillData(),this.saveInvoiceData()]).then((([e,t])=>{console.log("Entry details updated:",e.data),console.log("Waybill details updated:",t.data),Ee(),De("All Data Saved successfully!")})).catch((e=>{console.error("There was an error saving the data!",e),we("Failed to save Entry Data!")})).finally((()=>{this.loading=!1}))},naStyle(e){return[null,void 0,"",!1].includes(e)?{backgroundColor:"yellow",color:"black"}:{}},calculateTotalExtensionPrice(e){return e.reduce(((e,t)=>e+parseFloat(t.extension_price||0)),0).toFixed(2)},extensionStyle(e){const t=(parseFloat(e.unit_price)*parseFloat(e.quantity)).toFixed(2),n=parseFloat(e.extension_price).toFixed(2);return[e.unit_price,e.quantity,e.extension_price].some((e=>[null,void 0,"",!1].includes(e)))?{backgroundColor:"yellow",color:"black"}:t!==n?{backgroundColor:"red",color:"white"}:{}},checkInvoiceTotal(e){const t=this.calculateTotalExtensionPrice(e.lines),n=parseFloat(e.invoice_total||0).toFixed(2);return t!==n?{backgroundColor:"red",color:"white"}:{}},toggleOptions(){console.log(this.freightType)},updateEntryFields(e,t){console.log(e,t),this.entryDetails[e]=t},updateInvoiceData(e,t,n){e[t]=n,console.log(e)},async fetchAllDetails(){const e="https://mawifrontend.azurewebsites.net/";console.log("Fetching details"),this.loading=!0,this.dataRetrieved=!1;try{const t=me().get(`${e}entry-details/${this.entryId}`),n=me().get(`${e}commercial-invoices-with-lines/${this.entryId}`),[l,r]=await Promise.all([t,n]);this.dataRetrieved=!0,this.entryDetails=l.data,this.commercialInvoices=r.data,console.log("Entry details:",this.entryDetails),console.log("Commercial invoices:",this.commercialInvoices)}catch(t){this.error="Failed to load entry details: "+(t.response?.data||t.message)}finally{this.loading=!1}},async updateWaybillData(){return this.waybill={waybill_number:this.entryDetails.waybill_number,waybill_date:this.entryDetails.waybill_date,mode_of_transport:this.entryDetails.mode_of_transport,freight_type:this.entryDetails.freight_type,marks_and_numbers:this.entryDetails.marks_and_numbers,package_type:this.entryDetails.package_type,cpc_code:this.entryDetails.cpc_code,npc_code:this.entryDetails.npc_code,package_quantity:this.entryDetails.package_quantity,country_of_origin:this.entryDetails.country_of_origin,entry_id:this.entryDetails.entry_id,waybill_id:this.entryDetails.waybill_id},console.log("Saving Waybill Data: ",this.waybill),me().put(`https://mawifrontend.azurewebsites.net/waybill/${this.waybill.waybill_id}`,this.waybill)},async updateEntryData(){return this.entry={mawi_invoice:this.entryDetails.mawi_invoice,entry_date:this.entryDetails.entry_date,invoice_total:this.entryDetails.invoice_total,supplier_name:this.entryDetails.supplier_name,gross_weight:this.entryDetails.gross_weight,net_weight:this.entryDetails.net_weight,entry_number:this.entryDetails.entry_number,freight_charge:this.entryDetails.freight_charge,rate_of_exchange:this.entryDetails.rate_of_exchange,consignee:this.entryDetails.consignee,shipper:this.entryDetails.shipper},console.log(this.entryDetails),me().put(`https://mawifrontend.azurewebsites.net/customs-entry/${this.entryDetails.entry_id}`,this.entryDetails)},async saveInvoiceData(){const e=this.commercialInvoices.map((e=>{const t=this.formatInvoiceData(e),n=this.formatInvoiceLinesData(e.lines),l={invoiceData:t,invoiceLines:n};return me().put(`https://mawifrontend.azurewebsites.net/update-invoice-and-lines/${t.invoice_id}`,l)}));return Promise.all(e)},checkTHNCodes(){let e=this.commercialInvoices;return e.forEach((e=>{e.lines.forEach((e=>{if(!e.tariff_code||""===e.tariff_code.trim()||"N/A"===e.tariff_code||void 0===e.tariff_code||null===e.tariff_code)return!1}))})),!0},generateCSV(){if(!this.checkTHNCodes())return void alert("Please enter a THN code for all items before generating the CSV file");let e=this.entryDetails,t=this.commercialInvoices;const n=e=>void 0!==e&&null!==e?`"${e.toString().replace(/"/g,'""')}"`:"",l=["reference","waybill_number","Product Code","description","commodity_code","quantity","unitcost","total","gross_weight","net_weight","country_origin_code","package_quantity","kind_of_package","marks_and_numbers","customs_procedure_code","national_procedure_code","exchange_rate"];let r=l.join(",")+"\n";console.log(e),t.forEach((t=>{for(let l=0;l<t.lines.length;l++){const i=t.lines[l];let o="0";0===l&&(o=e.package_quantity);const a=[n(e.entry_number),n(e.waybill_number),n(i.product_code),n(i.description),n(i.tariff_code.replace(/\./g,""))+"000",n(i.quantity),n(i.unit_price),n(i.extension_price),n(e.gross_weight),n(e.net_weight),n(e.country_of_origin),n(o),n(e.package_type),n(e.marks_and_numbers),n(e.cpc_code),n(e.npc_code),n(e.rate_of_exchange)];r+=a.join(",")+"\n"}}));const i=new Blob([r],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(i),a=document.createElement("a"),u=`GABRIEL-Export - ${e.entry_number}.csv`;a.setAttribute("href",o),a.setAttribute("download",u),document.body.appendChild(a),a.click(),document.body.removeChild(a),De("Successfully Generated CSV File!")}}};const jt=(0,u.A)(Kt,[["render",$t]]);var Qt=jt;const zt=[{path:"/",name:"NewEntry",component:Ie},{path:"/view-entries",name:"ViewEntries",component:Me},{path:"/entries/:entryId",name:"EntryDetails",component:Qt,props:!0}],Gt=(0,d.aE)({history:(0,d.LA)(),routes:zt});var Jt=Gt;(0,l.Ef)(c).use(Jt).mount("#app")}},t={};function n(l){var r=t[l];if(void 0!==r)return r.exports;var i=t[l]={exports:{}};return e[l].call(i.exports,i,i.exports,n),i.exports}n.m=e,function(){var e=[];n.O=function(t,l,r,i){if(!l){var o=1/0;for(c=0;c<e.length;c++){l=e[c][0],r=e[c][1],i=e[c][2];for(var a=!0,u=0;u<l.length;u++)(!1&i||o>=i)&&Object.keys(n.O).every((function(e){return n.O[e](l[u])}))?l.splice(u--,1):(a=!1,i<o&&(o=i));if(a){e.splice(c--,1);var s=r();void 0!==s&&(t=s)}}return t}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[l,r,i]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var l in t)n.o(t,l)&&!n.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,l){var r,i,o=l[0],a=l[1],u=l[2],s=0;if(o.some((function(t){return 0!==e[t]}))){for(r in a)n.o(a,r)&&(n.m[r]=a[r]);if(u)var c=u(n)}for(t&&t(l);s<o.length;s++)i=o[s],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(c)},l=self["webpackChunkasycuda_xml_automation"]=self["webpackChunkasycuda_xml_automation"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=n.O(void 0,[504],(function(){return n(7474)}));l=n.O(l)})();
//# sourceMappingURL=app.355dee80.js.map